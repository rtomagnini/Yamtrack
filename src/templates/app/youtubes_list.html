{% extends "base.html" %}
{% load static %}

{% block title %}Youtubes - Yamtrack{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6">Youtubes</h1>
<div x-data="{ search: '{{ search }}', status: '{{ current_status }}', sort: '{{ current_sort }}' }">
  <form method="get" class="flex flex-col md:flex-row gap-4 mb-6 items-end">
    <div class="flex-1">
      <label for="search" class="sr-only"></label>
      <input id="search" type="text" name="search" x-model="search" placeholder="Search videos..." autocomplete="on" class="w-full py-2 px-4 bg-[#39404b] rounded-md text-white focus:outline-none focus:ring-2 focus:ring-[#4a9eff]" />
    </div>
    <div class="flex items-center">
      <span class="mr-1 text-gray-400">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707l-6.414 6.414A1 1 0 0013 13.414V19a1 1 0 01-1.447.894l-2-1A1 1 0 019 18v-4.586a1 1 0 00-.293-.707L2.293 6.707A1 1 0 012 6V4z" /></svg>
      </span>
      <select name="status" x-model="status" class="py-2 px-3 rounded-md bg-[#39404b] text-white" onchange="this.form.submit()">
        <option value="all">All</option>
        <option value="watched">Watched</option>
        <option value="unwatched">Unwatched</option>
      </select>
    </div>
    <div class="flex items-center">
      <span class="mr-1 text-gray-400">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 17l-4 4m0 0l-4-4m4 4V3" /></svg>
      </span>
      <select name="sort" x-model="sort" class="py-2 px-3 rounded-md bg-[#39404b] text-white" onchange="this.form.submit()">
        <option value="title">Title</option>
        <option value="air_date">Air date</option>
        <option value="runtime">Runtime</option>
        <option value="end_date">End date</option>
      </select>
    </div>
  </form>

  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
    {% for video in videos %}
      <div class="bg-[#2a2f35] rounded-lg overflow-hidden shadow-lg flex flex-col">
        <div class="relative aspect-video bg-[#3e454d]">
          <img alt="{{ video.title }}" class="w-full h-full object-cover" src="{{ video.image }}" loading="lazy" />
        </div>
        <div class="p-4 flex-1 flex flex-col">
          <div class="font-semibold text-lg mb-1">{{ video.title }}</div>
          <div class="text-sm text-gray-400 mb-2">Channel: {{ video.channel_name|default:'—' }}</div>
          <div class="text-xs text-gray-400 mb-1">Air date: {{ video.air_date|date:'Y-m-d' }}</div>
          <div class="text-xs text-gray-400 mb-1">Runtime: {{ video.runtime|default:'—' }}</div>
          <div class="text-xs text-gray-400">End date: {{ video.end_date_sub|default:'—' }}</div>
        </div>
      </div>
    {% empty %}
      <div class="col-span-full text-center text-gray-400 py-12">No videos found.</div>
    {% endfor %}
  </div>
</div>
{% endblock %}
